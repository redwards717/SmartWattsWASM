@page "/profile";

@inject AppState _appState; 
@inject IStravaService _stravaService;
@inject NavigationManager _nav;

<h4>@_appState.LoggedInUser.Email</h4>

@if (String.IsNullOrWhiteSpace(_appState.LoggedInUser.StravaAccessCode) == false)
{
    <p>Linked to Strava ID: @_appState.LoggedInUser.StravaAccessCode</p>
}
else
{
    <button class="btn btn-strava" @onclick="RedirectToAuth">Link to Stava</button>
}


@code {
    [Parameter]
    public string Code { get; set; }

    

    private void RedirectToAuth()
    {
        _nav.NavigateTo($"https://www.strava.com/oauth/authorize?client_id={Constants.STRAVA_CLIENT_ID}&redirect_uri={Constants.BASE_URI}/oauth2&response_type=code&scope=activity:read_all,profile:read_all");
    }

    private async Task LinkToStrava()
    {

        await _stravaService.LinkToStrava();
    }

    

}

<style>
    .btn-strava {
        color: white;
        background-color: #fc5200;
    }
</style>
